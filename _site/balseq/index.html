<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Sequential balanced sampling - Raphaël Jauslin</title>
<meta name="description" content="Example of sequential spatially balanced sampling.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Raphaël Jauslin">
<meta property="og:title" content="Sequential balanced sampling">
<meta property="og:url" content="http://localhost:4000/balseq/">


  <meta property="og:description" content="Example of sequential spatially balanced sampling.">







  <meta property="article:published_time" content="2022-06-06T00:00:00+02:00">





  

  


<link rel="canonical" href="http://localhost:4000/balseq/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Raphaël Jauslin",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Raphaël Jauslin Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- Mathjax Support -->
<script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Raphaël Jauslin
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">Home</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">About</a>
            </li><li class="masthead__menu-item">
              <a href="/assets/CV/ClassicCV.pdf">Resume</a>
            </li><li class="masthead__menu-item">
              <a href="/publications/">Publications</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url"></a>
    </h3>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>
  
    
      
      
      
      
    
    
      

<nav class="nav__list">
  
  <input id="ac-toc" name="accordion-toc" type="checkbox" />
  <label for="ac-toc">Toggle menu</label>
  <ul class="nav__items">
    
      <li>
        
          <span class="nav__sub-title">Posts</span>
        

        
        <ul>
          
            <li><a href="/wave/">Wave Sampling</a></li>
          
            <li><a href="/matching/">Statistical Matching</a></li>
          
            <li><a href="/balseq/" class="active">Sequential Balanced Sampling</a></li>
          
            <li><a href="/deville/">Deville systematic</a></li>
          
        </ul>
        
      </li>
    
  </ul>
</nav>

    
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Sequential balanced sampling">
    <meta itemprop="description" content="Example of sequential spatially balanced sampling.">
    <meta itemprop="datePublished" content="2022-06-06T00:00:00+02:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/balseq/" class="u-url" itemprop="url">Sequential balanced sampling
</a>
          </h1>
          


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
        <h2 id="introduction">Introduction</h2>

<p>In this vignette we are going to explain how to use the function <code class="language-plaintext highlighter-rouge">balseq</code> to select a balanced sample.</p>

<h2 id="load-data">Load data</h2>
<p>We will use the dataset <code class="language-plaintext highlighter-rouge">belgianmunicipalties</code> from the package <code class="language-plaintext highlighter-rouge">sampling</code>. The dataset does not contains any spatial coordinates. Luckily, a <code class="language-plaintext highlighter-rouge">GEOjson</code> is directly available from the <a href="https://hub.arcgis.com/datasets/esribeluxdata::belgium-municipalities-1/about">https://hub.arcgis.com/datasets/esribeluxdata::belgium-municipalities-1/about</a>. We can then transform it into a <code class="language-plaintext highlighter-rouge">sf</code> object and calculate the centroid of the municipalities. We will use these centroid as spatial coordinates to spread the sample over the space.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># to load data</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">sampling</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">geojsonio</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w"> 
</span><span class="n">library</span><span class="p">(</span><span class="n">viridis</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">rgeos</span><span class="p">)</span><span class="w"> 
</span><span class="n">library</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">rmapshaper</span><span class="p">)</span><span class="w">

</span><span class="n">data</span><span class="p">(</span><span class="s2">"belgianmunicipalities"</span><span class="p">)</span><span class="w">

</span><span class="c1"># load geojson directly from the url</span><span class="w">
</span><span class="n">belg</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">geojson_read</span><span class="p">(</span><span class="s2">"https://opendata.arcgis.com/datasets/9589d9e5e5904f1ea8d245b54f51b4fd_0.geojson"</span><span class="p">,</span><span class="n">what</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sp"</span><span class="p">)</span><span class="w">

</span><span class="c1"># simplify the variable and transform it into a sf object</span><span class="w">
</span><span class="n">belg</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rmapshaper</span><span class="o">::</span><span class="n">ms_simplify</span><span class="p">(</span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">belg</span><span class="p">,</span><span class="n">keep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">st_as_sf</span><span class="p">()</span><span class="w">

</span><span class="n">coord</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gCentroid</span><span class="p">(</span><span class="n">as</span><span class="p">(</span><span class="n">belg</span><span class="p">,</span><span class="w"> </span><span class="s2">"Spatial"</span><span class="p">),</span><span class="w"> </span><span class="n">byid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">

</span><span class="c1"># concatenated file</span><span class="w">
</span><span class="n">Belgium</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">belg</span><span class="p">,</span><span class="n">belgianmunicipalities</span><span class="p">,</span><span class="n">coord</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">Belgium</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">#&gt; Simple feature collection with 6 features and 26 fields
#&gt; Geometry type: MULTIPOLYGON
#&gt; Dimension:     XY
#&gt; Bounding box:  xmin: 4.216306 ymin: 51.08066 xmax: 4.564865 ymax: 51.37764
#&gt; Geodetic CRS:  WGS 84
#&gt;   OBJECTID   ADMUNAFR   ADMUNADU   ADMUNAGE   Communes CODE_INS arrond    Commune   INS Province Arrondiss
#&gt; 1        1 AARTSELAAR AARTSELAAR AARTSELAAR Aartselaar    11001     11 Aartselaar 11001        1        11
#&gt; 2        2     ANVERS  ANTWERPEN  ANTWERPEN  Antwerpen    11002     11     Anvers 11002        1        11
#&gt; 3        3   BOECHOUT   BOECHOUT   BOECHOUT   Boechout    11004     11   Boechout 11004        1        11
#&gt; 4        4       BOOM       BOOM       BOOM       Boom    11005     11       Boom 11005        1        11
#&gt; 5        5   BORSBEEK   BORSBEEK   BORSBEEK   Borsbeek    11007     11   Borsbeek 11007        1        11
#&gt; 6        6 BRASSCHAAT BRASSCHAAT BRASSCHAAT Brasschaat    11008     11 Brasschaat 11008        1        11
#&gt;    Men04 Women04  Tot04  Men03 Women03  Tot03 Diffmen Diffwom DiffTOT TaxableIncome Totaltaxation averageincome
#&gt; 1   6971    7169  14140   7010    7243  14253     -39     -74    -113     242104077      74976114         33809
#&gt; 2 223677  233642 457319 221767  232405 454172    1910    1237    3147    5416418842    1423715652         22072
#&gt; 3   6027    5927  11954   6005    5942  11947      22     -15       7     167616996      50739035         29453
#&gt; 4   7640    8066  15706   7535    7952  15487     105     114     219     186075961      46636930         21907
#&gt; 5   4948    5328  10276   4951    5322  10273      -3       6       3     143225590      40564374         26632
#&gt; 6  18142   18916  37058  18217   18903  37120     -75      13     -62     533368826     153629397         30574
#&gt;   medianincome        x        y                       geometry
#&gt; 1        23901 4.382005 51.13223 MULTIPOLYGON (((4.400451 51...
#&gt; 2        17226 4.369578 51.26067 MULTIPOLYGON (((4.368136 51...
#&gt; 3        21613 4.516463 51.16576 MULTIPOLYGON (((4.530071 51...
#&gt; 4        17537 4.371434 51.09387 MULTIPOLYGON (((4.385267 51...
#&gt; 5        20739 4.488162 51.19138 MULTIPOLYGON (((4.509002 51...
#&gt; 6        21523 4.500281 51.30940 MULTIPOLYGON (((4.540815 51...</code></pre></figure>

<p>A <code class="language-plaintext highlighter-rouge">sf</code> object can be directly plotted using the function <code class="language-plaintext highlighter-rouge">geom_sf</code> from the package <code class="language-plaintext highlighter-rouge">ggplot2</code>.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">()</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_sf</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Belgium</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">averageincome</span><span class="p">),</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_fill_viridis_c</span><span class="p">(</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"G"</span><span class="p">)</span><span class="w">
</span><span class="n">p</span></code></pre></figure>

<p><img src="/figs/sequential_balanced/unnamed-chunk-3-1.png" title="center" alt="center" width="100%" /></p>

<h2 id="inclusion-probabilites">Inclusion probabilites</h2>

<p>Firstly, we define the variable of interest, the auxiliary variables and the inclusion probabilities. We set up here the inclusion probabilities equal with sum equal to 50. i.e. the sample will contain 50 units.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">N</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">Belgium</span><span class="p">)</span><span class="w"> </span><span class="c1"># population total</span><span class="w">
</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="c1"># sample size</span><span class="w">

</span><span class="c1"># variable of interest</span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">belgianmunicipalities</span><span class="o">$</span><span class="n">averageincome</span><span class="w">

</span><span class="c1"># auxiliary variables</span><span class="w">
</span><span class="n">Xaux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">belgianmunicipalities</span><span class="o">$</span><span class="n">Tot04</span><span class="p">,</span><span class="w">
              </span><span class="n">belgianmunicipalities</span><span class="o">$</span><span class="n">Women04</span><span class="p">,</span><span class="w">
              </span><span class="n">belgianmunicipalities</span><span class="o">$</span><span class="n">TaxableIncome</span><span class="p">,</span><span class="w">
              </span><span class="n">belgianmunicipalities</span><span class="o">$</span><span class="n">Diffmen</span><span class="p">,</span><span class="w">
              </span><span class="n">belgianmunicipalities</span><span class="o">$</span><span class="n">Diffwom</span><span class="p">)</span><span class="w">


</span><span class="c1"># inclusion probabilities</span><span class="w">
</span><span class="n">pik</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="n">n</span><span class="o">/</span><span class="n">N</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w">

</span><span class="n">Xaux</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cbind</span><span class="p">(</span><span class="n">pik</span><span class="p">,</span><span class="n">Xaux</span><span class="p">)</span><span class="w"> </span><span class="c1"># add pik to fixed sample size</span><span class="w">
</span><span class="n">Xspread</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">coord</span></code></pre></figure>

<h2 id="balanced-sampling">Balanced sampling</h2>

<p>We can now load the package <code class="language-plaintext highlighter-rouge">StratifiedSampling</code> and use the function <code class="language-plaintext highlighter-rouge">balseq</code> on the variables that we just defined. We can check that our method is selecting effectively a balanced sample by observing if the auxiliary totals are respected compared to a maximal entropy design (also know as conditional Poisson sampling).</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">StratifiedSampling</span><span class="p">)</span><span class="w">

</span><span class="n">s</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">balseq</span><span class="p">(</span><span class="n">pik</span><span class="p">,</span><span class="n">Xaux</span><span class="p">)</span><span class="w">
</span><span class="n">s_cube</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">samplecube</span><span class="p">(</span><span class="n">Xaux</span><span class="p">,</span><span class="n">pik</span><span class="p">,</span><span class="n">comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
</span><span class="n">s_srs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">srswor</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">N</span><span class="p">)</span><span class="w">


</span><span class="n">TOT</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colSums</span><span class="p">(</span><span class="n">Xaux</span><span class="p">)</span><span class="w">
</span><span class="n">EST1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colSums</span><span class="p">(</span><span class="n">Xaux</span><span class="p">[</span><span class="n">s</span><span class="p">,]</span><span class="o">/</span><span class="n">pik</span><span class="p">[</span><span class="n">s</span><span class="p">])</span><span class="w">
</span><span class="n">EST2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colSums</span><span class="p">(</span><span class="n">Xaux</span><span class="p">[</span><span class="n">s_cube</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">,]</span><span class="o">/</span><span class="n">pik</span><span class="p">[</span><span class="n">s_cube</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">])</span><span class="w">
</span><span class="n">EST3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">colSums</span><span class="p">(</span><span class="n">Xaux</span><span class="p">[</span><span class="n">s_srs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">,]</span><span class="o">/</span><span class="n">pik</span><span class="p">[</span><span class="n">s_srs</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">])</span><span class="w">


</span><span class="m">100</span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">EST1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">TOT</span><span class="p">)</span><span class="o">/</span><span class="n">TOT</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">#&gt;       pik                                                   
#&gt;  0.000000  4.908396  4.890552  6.873691 14.225213  6.440032</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">100</span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">EST2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">TOT</span><span class="p">)</span><span class="o">/</span><span class="n">TOT</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">#&gt;        pik                                                        
#&gt;   0.000000  -4.068363  -4.153367  -8.105537 -19.212958 -14.508554</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="m">100</span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">EST3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">TOT</span><span class="p">)</span><span class="o">/</span><span class="n">TOT</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">#&gt;       pik                                                   
#&gt;   0.00000  12.99101  12.52005  12.72183 -13.28123 -21.77427</code></pre></figure>

<h2 id="spread-sampling">Spread sampling</h2>

<p>To add the spatial component, we can simply add the spatial coordinates as a matrix to the argument <code class="language-plaintext highlighter-rouge">Xspread</code> of the function. Here <code class="language-plaintext highlighter-rouge">coord</code> is an output of the function <code class="language-plaintext highlighter-rouge">gCentroid</code> which is by construction an <code class="language-plaintext highlighter-rouge">S4</code> object. To get the <code class="language-plaintext highlighter-rouge">data.frame</code> that are encapsulated inside, we simply use the <code class="language-plaintext highlighter-rouge">@coords</code> operator.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">s</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="n">balseq</span><span class="p">(</span><span class="n">pik</span><span class="p">,</span><span class="w">
             </span><span class="n">Xaux</span><span class="p">,</span><span class="w">
             </span><span class="n">Xspread</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.matrix</span><span class="p">(</span><span class="n">Xspread</span><span class="o">@</span><span class="n">coords</span><span class="p">))</span><span class="w">
</span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Belgium</span><span class="p">,</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Belgium</span><span class="p">[</span><span class="n">s</span><span class="p">,],</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">),</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">)</span><span class="o">+</span><span class="w">
  </span><span class="n">scale_fill_viridis_c</span><span class="p">(</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"G"</span><span class="p">)</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-text" data-lang="text">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which will replace the existing scale.</code></pre></figure>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">p</span></code></pre></figure>

<p><img src="/figs/sequential_balanced/unnamed-chunk-6-1.png" title="center" alt="center" width="100%" /></p>


        
      </section>

      <footer class="page__meta">
        
        


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2022-06-06T00:00:00+02:00">June 6, 2022</time></p>

      </footer>

      

      <!-- 
  <nav class="pagination">
    
      <a href="/wave/" class="pagination--pager" title="Wave Sampling
">Previous</a>
    
    
      <a href="/deville/" class="pagination--pager" title="Deville systematic
">Next</a>
    
  </nav>
 -->
    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You may also enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/deville/" rel="permalink">Deville systematic
</a>
      
    </h2>
    


    <p class="archive__item-excerpt" itemprop="description">Deville’s systematic second-order inclusion probabilities.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/wave/" rel="permalink">Wave Sampling
</a>
      
    </h2>
    


    <p class="archive__item-excerpt" itemprop="description">Example of weakly associated vector on the Meuse dataset.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/matching/" rel="permalink">Statistical Matching using Optimal Transport
</a>
      
    </h2>
    


    <p class="archive__item-excerpt" itemprop="description">Example of statistical matching using optimal transport.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Raphaël Jauslin. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
